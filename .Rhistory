train_data3 <- data[!(data$building_code %in% test_build3),]
test_data3 <- data[data$building_code %in% test_build3,]
train_data4 <- data[!(data$building_code %in% test_build4),]
test_data4 <- data[data$building_code %in% test_build4,]
train_data5 <- data[!(data$building_code %in% test_build5),]
test_data5 <- data[data$building_code %in% test_build5,]
fold1_results <- gr_cv(train_data1, test_data1)
fold2_results <- gr_cv(train_data2, test_data2)
fold3_results <- gr_cv(train_data3, test_data3)
fold4_results <- gr_cv(train_data4, test_data4)
fold5_results <- gr_cv(train_data5, test_data5)
sqrt_gr_test <- c(fold1_results[[1]], fold2_results[[1]], fold3_results[[1]],
fold4_results[[1]], fold5_results[[1]])
gr_test <- c(fold1_results[[2]], fold2_results[[2]], fold3_results[[2]],
fold4_results[[2]], fold5_results[[2]])
rf_gr_test <- c(fold1_results[[3]], fold2_results[[3]], fold3_results[[3]],
fold4_results[[3]], fold5_results[[3]])
og_sqrt_preds <- c(fold1_results[[4]], fold2_results[[4]], fold3_results[[4]],
fold4_results[[4]], fold5_results[[4]])
new_sqrt_preds <- c(fold1_results[[5]], fold2_results[[5]], fold3_results[[5]],
fold4_results[[5]], fold5_results[[5]])
og_gr_preds <- c(fold1_results[[6]], fold2_results[[6]], fold3_results[[6]],
fold4_results[[6]], fold5_results[[6]])
new_gr_preds <- c(fold1_results[[7]], fold2_results[[7]], fold3_results[[7]],
fold4_results[[7]], fold5_results[[7]])
rf_gr_preds <- c(fold1_results[[8]], fold2_results[[8]], fold3_results[[8]],
fold4_results[[8]], fold5_results[[8]])
rmse(sqrt_gr_test, og_sqrt_preds)
rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
median(abs(sqrt_gr_test - og_sqrt_preds))
median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse(gr_test, og_gr_preds)
rmse(gr_test[!is.na(new_gr_preds)], na.omit(new_gr_preds))
rmse(rf_gr_test, rf_gr_preds)
median(abs((gr_test - og_gr_preds)))
median(abs((gr_test[!is.na(new_gr_preds)] - na.omit(new_gr_preds))))
median(abs((rf_gr_test - rf_gr_preds)))
# Partitioning based on observations
## setting each observation as being in fold 1-5
obs_nums <- sample(rep_len(1:5,nrow(data)))
obs_train_data1 <- data[obs_nums != 1,]
obs_test_data1 <- data[obs_nums == 1,]
obs_train_data2 <- data[obs_nums != 2,]
obs_test_data2 <- data[obs_nums == 2,]
obs_train_data3 <- data[obs_nums != 3,]
obs_test_data3 <- data[obs_nums == 3,]
obs_train_data4 <- data[obs_nums != 4,]
obs_test_data4 <- data[obs_nums == 4,]
obs_train_data5 <- data[obs_nums != 5,]
obs_test_data5 <- data[obs_nums == 5,]
obs_fold1_results <- gr_cv(obs_train_data1, obs_test_data1)
obs_fold2_results <- gr_cv(obs_train_data2, obs_test_data2)
obs_fold3_results <- gr_cv(obs_train_data3, obs_test_data3)
obs_fold4_results <- gr_cv(obs_train_data4, obs_test_data4)
obs_fold5_results <- gr_cv(obs_train_data5, obs_test_data5)
sqrt_gr_test <- c(obs_fold1_results[[1]], obs_fold2_results[[1]], obs_fold3_results[[1]],
obs_fold4_results[[1]], obs_fold5_results[[1]])
gr_test <- c(obs_fold1_results[[2]], obs_fold2_results[[2]], obs_fold3_results[[2]],
obs_fold4_results[[2]], obs_fold5_results[[2]])
rf_gr_test <- c(obs_fold1_results[[3]], obs_fold2_results[[3]], obs_fold3_results[[3]],
obs_fold4_results[[3]], obs_fold5_results[[3]])
og_sqrt_preds <- c(obs_fold1_results[[4]], obs_fold2_results[[4]], obs_fold3_results[[4]],
obs_fold4_results[[4]], obs_fold5_results[[4]])
new_sqrt_preds <- c(obs_fold1_results[[5]], obs_fold2_results[[5]], obs_fold3_results[[5]],
obs_fold4_results[[5]], obs_fold5_results[[5]])
og_gr_preds <- c(obs_fold1_results[[6]], obs_fold2_results[[6]], obs_fold3_results[[6]],
obs_fold4_results[[6]], obs_fold5_results[[6]])
new_gr_preds <- c(obs_fold1_results[[7]], obs_fold2_results[[7]], obs_fold3_results[[7]],
obs_fold4_results[[7]], obs_fold5_results[[7]])
rf_gr_preds <- c(obs_fold1_results[[8]], obs_fold2_results[[8]], obs_fold3_results[[8]],
obs_fold4_results[[8]], obs_fold5_results[[8]])
rmse(sqrt_gr_test, og_sqrt_preds)
rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
median(abs(sqrt_gr_test - og_sqrt_preds))
median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse(gr_test, og_gr_preds)
rmse(gr_test[!is.na(new_gr_preds)], na.omit(new_gr_preds))
rmse(rf_gr_test, rf_gr_preds)
median(abs((gr_test - og_gr_preds)))
median(abs((gr_test[!is.na(new_gr_preds)] - na.omit(new_gr_preds))))
median(abs((rf_gr_test - rf_gr_preds)))
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
set.seed(2319)
## setting each building as being in fold 1-5
building_nums <- sample(rep_len(1:5,length(unique(data$building_code))))
# putting numbers to building codes
test_build1 <- unique(data$building_code)[building_nums == 1]
test_build2 <- unique(data$building_code)[building_nums == 2]
test_build3 <- unique(data$building_code)[building_nums == 2]
test_build4 <- unique(data$building_code)[building_nums == 4]
test_build5 <- unique(data$building_code)[building_nums == 5]
## making train and test data based on each fold
train_data1 <- data[!(data$building_code %in% test_build1),]
test_data1 <- data[data$building_code %in% test_build1,]
train_data2 <- data[!(data$building_code %in% test_build2),]
test_data2 <- data[data$building_code %in% test_build2,]
train_data3 <- data[!(data$building_code %in% test_build3),]
test_data3 <- data[data$building_code %in% test_build3,]
train_data4 <- data[!(data$building_code %in% test_build4),]
test_data4 <- data[data$building_code %in% test_build4,]
train_data5 <- data[!(data$building_code %in% test_build5),]
test_data5 <- data[data$building_code %in% test_build5,]
fold1_results <- gr_cv(train_data1, test_data1)
fold2_results <- gr_cv(train_data2, test_data2)
fold3_results <- gr_cv(train_data3, test_data3)
fold4_results <- gr_cv(train_data4, test_data4)
fold5_results <- gr_cv(train_data5, test_data5)
sqrt_gr_test <- c(fold1_results[[1]], fold2_results[[1]], fold3_results[[1]],
fold4_results[[1]], fold5_results[[1]])
gr_test <- c(fold1_results[[2]], fold2_results[[2]], fold3_results[[2]],
fold4_results[[2]], fold5_results[[2]])
rf_gr_test <- c(fold1_results[[3]], fold2_results[[3]], fold3_results[[3]],
fold4_results[[3]], fold5_results[[3]])
og_sqrt_preds <- c(fold1_results[[4]], fold2_results[[4]], fold3_results[[4]],
fold4_results[[4]], fold5_results[[4]])
new_sqrt_preds <- c(fold1_results[[5]], fold2_results[[5]], fold3_results[[5]],
fold4_results[[5]], fold5_results[[5]])
og_gr_preds <- c(fold1_results[[6]], fold2_results[[6]], fold3_results[[6]],
fold4_results[[6]], fold5_results[[6]])
new_gr_preds <- c(fold1_results[[7]], fold2_results[[7]], fold3_results[[7]],
fold4_results[[7]], fold5_results[[7]])
rf_gr_preds <- c(fold1_results[[8]], fold2_results[[8]], fold3_results[[8]],
fold4_results[[8]], fold5_results[[8]])
rmse(sqrt_gr_test, og_sqrt_preds)
rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
median(abs(sqrt_gr_test - og_sqrt_preds))
median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse(gr_test, og_gr_preds)
rmse(gr_test[!is.na(new_gr_preds)], na.omit(new_gr_preds))
rmse(rf_gr_test, rf_gr_preds)
median(abs((gr_test - og_gr_preds)))
median(abs((gr_test[!is.na(new_gr_preds)] - na.omit(new_gr_preds))))
median(abs((rf_gr_test - rf_gr_preds)))
## setting each observation as being in fold 1-5
obs_nums <- sample(rep_len(1:5,nrow(data)))
obs_train_data1 <- data[obs_nums != 1,]
obs_test_data1 <- data[obs_nums == 1,]
obs_train_data2 <- data[obs_nums != 2,]
obs_test_data2 <- data[obs_nums == 2,]
obs_train_data3 <- data[obs_nums != 3,]
obs_test_data3 <- data[obs_nums == 3,]
obs_train_data4 <- data[obs_nums != 4,]
obs_test_data4 <- data[obs_nums == 4,]
obs_train_data5 <- data[obs_nums != 5,]
obs_test_data5 <- data[obs_nums == 5,]
obs_fold1_results <- gr_cv(obs_train_data1, obs_test_data1)
obs_fold2_results <- gr_cv(obs_train_data2, obs_test_data2)
obs_fold3_results <- gr_cv(obs_train_data3, obs_test_data3)
obs_fold4_results <- gr_cv(obs_train_data4, obs_test_data4)
obs_fold5_results <- gr_cv(obs_train_data5, obs_test_data5)
sqrt_gr_test <- c(obs_fold1_results[[1]], obs_fold2_results[[1]], obs_fold3_results[[1]],
obs_fold4_results[[1]], obs_fold5_results[[1]])
gr_test <- c(obs_fold1_results[[2]], obs_fold2_results[[2]], obs_fold3_results[[2]],
obs_fold4_results[[2]], obs_fold5_results[[2]])
rf_gr_test <- c(obs_fold1_results[[3]], obs_fold2_results[[3]], obs_fold3_results[[3]],
obs_fold4_results[[3]], obs_fold5_results[[3]])
og_sqrt_preds <- c(obs_fold1_results[[4]], obs_fold2_results[[4]], obs_fold3_results[[4]],
obs_fold4_results[[4]], obs_fold5_results[[4]])
new_sqrt_preds <- c(obs_fold1_results[[5]], obs_fold2_results[[5]], obs_fold3_results[[5]],
obs_fold4_results[[5]], obs_fold5_results[[5]])
og_gr_preds <- c(obs_fold1_results[[6]], obs_fold2_results[[6]], obs_fold3_results[[6]],
obs_fold4_results[[6]], obs_fold5_results[[6]])
new_gr_preds <- c(obs_fold1_results[[7]], obs_fold2_results[[7]], obs_fold3_results[[7]],
obs_fold4_results[[7]], obs_fold5_results[[7]])
rf_gr_preds <- c(obs_fold1_results[[8]], obs_fold2_results[[8]], obs_fold3_results[[8]],
obs_fold4_results[[8]], obs_fold5_results[[8]])
rmse(sqrt_gr_test, og_sqrt_preds)
rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
median(abs(sqrt_gr_test - og_sqrt_preds))
median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse(gr_test, og_gr_preds)
rmse(gr_test[!is.na(new_gr_preds)], na.omit(new_gr_preds))
rmse(rf_gr_test, rf_gr_preds)
median(abs((gr_test - og_gr_preds)))
median(abs((gr_test[!is.na(new_gr_preds)] - na.omit(new_gr_preds))))
median(abs((rf_gr_test - rf_gr_preds)))
devtools::document()
devtools::document()
devtools::load_all()
library(Metrics)
library(randomForest)
library(e1071)
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
set.seed(2319)
## setting each building as being in fold 1-5
building_nums <- sample(rep_len(1:5,length(unique(data$building_code))))
# putting numbers to building codes
test_build1 <- unique(data$building_code)[building_nums == 1]
test_build2 <- unique(data$building_code)[building_nums == 2]
test_build3 <- unique(data$building_code)[building_nums == 2]
test_build4 <- unique(data$building_code)[building_nums == 4]
test_build5 <- unique(data$building_code)[building_nums == 5]
## making train and test data based on each fold
train_data1 <- data[!(data$building_code %in% test_build1),]
test_data1 <- data[data$building_code %in% test_build1,]
train_data2 <- data[!(data$building_code %in% test_build2),]
test_data2 <- data[data$building_code %in% test_build2,]
train_data3 <- data[!(data$building_code %in% test_build3),]
test_data3 <- data[data$building_code %in% test_build3,]
train_data4 <- data[!(data$building_code %in% test_build4),]
test_data4 <- data[data$building_code %in% test_build4,]
train_data5 <- data[!(data$building_code %in% test_build5),]
test_data5 <- data[data$building_code %in% test_build5,]
fold1_results <- gr_cv(train_data1, test_data1)
colnames(train_data1)
devtools::document()
fold1_results <- gr_cv(train_data1, test_data1)
fold2_results <- gr_cv(train_data2, test_data2)
fold3_results <- gr_cv(train_data3, test_data3)
fold4_results <- gr_cv(train_data4, test_data4)
fold5_results <- gr_cv(train_data5, test_data5)
library(Metrics)
library(randomForest)
library(e1071)
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
set.seed(2319)
## setting each building as being in fold 1-5
building_nums <- sample(rep_len(1:5,length(unique(data$building_code))))
# putting numbers to building codes
test_build1 <- unique(data$building_code)[building_nums == 1]
test_build2 <- unique(data$building_code)[building_nums == 2]
test_build3 <- unique(data$building_code)[building_nums == 2]
test_build4 <- unique(data$building_code)[building_nums == 4]
test_build5 <- unique(data$building_code)[building_nums == 5]
## making train and test data based on each fold
train_data1 <- data[!(data$building_code %in% test_build1),]
test_data1 <- data[data$building_code %in% test_build1,]
train_data2 <- data[!(data$building_code %in% test_build2),]
test_data2 <- data[data$building_code %in% test_build2,]
train_data3 <- data[!(data$building_code %in% test_build3),]
test_data3 <- data[data$building_code %in% test_build3,]
train_data4 <- data[!(data$building_code %in% test_build4),]
test_data4 <- data[data$building_code %in% test_build4,]
train_data5 <- data[!(data$building_code %in% test_build5),]
test_data5 <- data[data$building_code %in% test_build5,]
fold1_results <- gr_cv(train_data1, test_data1)
fold2_results <- gr_cv(train_data2, test_data2)
devtools::load_all()
fold1_results <- gr_cv(train_data1, test_data1)
fold2_results <- gr_cv(train_data2, test_data2)
fold3_results <- gr_cv(train_data3, test_data3)
fold4_results <- gr_cv(train_data4, test_data4)
fold5_results <- gr_cv(train_data5, test_data5)
sqrt_gr_test <- c(fold1_results[[1]], fold2_results[[1]], fold3_results[[1]],
fold4_results[[1]], fold5_results[[1]])
gr_test <- c(fold1_results[[2]], fold2_results[[2]], fold3_results[[2]],
fold4_results[[2]], fold5_results[[2]])
rf_gr_test <- c(fold1_results[[3]], fold2_results[[3]], fold3_results[[3]],
fold4_results[[3]], fold5_results[[3]])
og_sqrt_preds <- c(fold1_results[[4]], fold2_results[[4]], fold3_results[[4]],
fold4_results[[4]], fold5_results[[4]])
new_sqrt_preds <- c(fold1_results[[5]], fold2_results[[5]], fold3_results[[5]],
fold4_results[[5]], fold5_results[[5]])
og_gr_preds <- c(fold1_results[[6]], fold2_results[[6]], fold3_results[[6]],
fold4_results[[6]], fold5_results[[6]])
new_gr_preds <- c(fold1_results[[7]], fold2_results[[7]], fold3_results[[7]],
fold4_results[[7]], fold5_results[[7]])
rf_gr_preds <- c(fold1_results[[8]], fold2_results[[8]], fold3_results[[8]],
fold4_results[[8]], fold5_results[[8]])
rmse(sqrt_gr_test, og_sqrt_preds)
rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
median(abs(sqrt_gr_test - og_sqrt_preds))
median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse(gr_test, og_gr_preds)
rmse(gr_test[!is.na(new_gr_preds)], na.omit(new_gr_preds))
rmse(rf_gr_test, rf_gr_preds)
median(abs((gr_test - og_gr_preds)))
median(abs((gr_test[!is.na(new_gr_preds)] - na.omit(new_gr_preds))))
median(abs((rf_gr_test - rf_gr_preds)))
?lm
?predict
?na.omit
devtools::document()
fold1_results <- gr_cv(train_data1, test_data1)
fold2_results <- gr_cv(train_data2, test_data2)
fold3_results <- gr_cv(train_data3, test_data3)
fold4_results <- gr_cv(train_data4, test_data4)
fold5_results <- gr_cv(train_data5, test_data5)
sqrt_gr_test <- c(fold1_results[[1]], fold2_results[[1]], fold3_results[[1]],
fold4_results[[1]], fold5_results[[1]])
gr_test <- c(fold1_results[[2]], fold2_results[[2]], fold3_results[[2]],
fold4_results[[2]], fold5_results[[2]])
rf_gr_test <- c(fold1_results[[3]], fold2_results[[3]], fold3_results[[3]],
fold4_results[[3]], fold5_results[[3]])
og_sqrt_preds <- c(fold1_results[[4]], fold2_results[[4]], fold3_results[[4]],
fold4_results[[4]], fold5_results[[4]])
new_sqrt_preds <- c(fold1_results[[5]], fold2_results[[5]], fold3_results[[5]],
fold4_results[[5]], fold5_results[[5]])
og_gr_preds <- c(fold1_results[[6]], fold2_results[[6]], fold3_results[[6]],
fold4_results[[6]], fold5_results[[6]])
new_gr_preds <- c(fold1_results[[7]], fold2_results[[7]], fold3_results[[7]],
fold4_results[[7]], fold5_results[[7]])
rf_gr_preds <- c(fold1_results[[8]], fold2_results[[8]], fold3_results[[8]],
fold4_results[[8]], fold5_results[[8]])
rmse(sqrt_gr_test, og_sqrt_preds)
rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
median(abs(sqrt_gr_test - og_sqrt_preds))
median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse(gr_test, og_gr_preds)
rmse(gr_test[!is.na(new_gr_preds)], na.omit(new_gr_preds))
?sample
?set.seed
?sample
?unique
is.na
?is.na
?na.omit
?median
devtools::document()
devtools::document()
acc_test(data = data, seed = 123)
devtools::document()
acc_test(data = data, seed = 123)
?rmse
devtools::document()
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
acc_test(data = data, seed = 123)
devtools::document()
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
acc_test(data = data, seed = 123)
devtools::document()
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
acc_test(data = data, seed = 123)
acc_test(data = data, seed = 123,
formula2 = "sqrtgr ~ logground + roofflat*Exposure +
roofflat*winter_wind +
log(Size) + temp_avg + Parapet")
View(data)
acc_test(data = data, seed = 123,
formula2 = "gr ~ gr")
acc_test(data = data, seed = 123,
formula2 = "gr ~ logground")
devtools::document()
acc_test(data = data, seed = 123,
formula2 = "gr ~ logground")
devtools::document()
acc_test(data = data, seed = 123)
acc_test(data = data, seed = 1234)
set.seed(1234)
building_nums <- sample(rep_len(1:5,length(unique(data$building_code))))
# putting numbers to building codes
test_build1 <- unique(data$building_code)[building_nums == 1]
test_build2 <- unique(data$building_code)[building_nums == 2]
test_build3 <- unique(data$building_code)[building_nums == 2]
test_build4 <- unique(data$building_code)[building_nums == 4]
test_build5 <- unique(data$building_code)[building_nums == 5]
## making train and test data based on each fold
train_data1 <- data[!(data$building_code %in% test_build1),]
test_data1 <- data[data$building_code %in% test_build1,]
train_data2 <- data[!(data$building_code %in% test_build2),]
test_data2 <- data[data$building_code %in% test_build2,]
train_data3 <- data[!(data$building_code %in% test_build3),]
test_data3 <- data[data$building_code %in% test_build3,]
train_data4 <- data[!(data$building_code %in% test_build4),]
test_data4 <- data[data$building_code %in% test_build4,]
train_data5 <- data[!(data$building_code %in% test_build5),]
test_data5 <- data[data$building_code %in% test_build5,]
fold1_results <- gr_cv(train_data1, test_data1,
formula1 = formula1,
forumula2 = formula2,
tree_vars = tree_vars,
rf_y = rf_y)
data <- read.csv("C:\\Users\\bean_student\\Documents\\gr_model_data.csv")
devtools::load_all()
formula1 = "sqrtgr ~ logground",
formula1 = "sqrtgr ~ logground"
formula2 = "sqrtgr ~ logground + roofflat*Exposure +
roofflat*winter_wind +
log(Size) + temp_avg + Heated + Parapet
tree_vars = c(7, 11, 13, 19:22, 25:27, 33, 35)
formula2 = "sqrtgr ~ logground + roofflat*Exposure +
formula1 = "sqrtgr ~ logground"
formula2 = "sqrtgr ~ logground + roofflat*Exposure +
roofflat*winter_wind +
log(Size) + temp_avg + Heated + Parapet"
tree_vars = c(7, 11, 13, 19:22, 25:27, 33, 35)
set.seed(1234)
building_nums <- sample(rep_len(1:5,length(unique(data$building_code))))
# putting numbers to building codes
test_build1 <- unique(data$building_code)[building_nums == 1]
test_build2 <- unique(data$building_code)[building_nums == 2]
test_build3 <- unique(data$building_code)[building_nums == 2]
test_build4 <- unique(data$building_code)[building_nums == 4]
test_build5 <- unique(data$building_code)[building_nums == 5]
## making train and test data based on each fold
train_data1 <- data[!(data$building_code %in% test_build1),]
test_data1 <- data[data$building_code %in% test_build1,]
train_data2 <- data[!(data$building_code %in% test_build2),]
test_data2 <- data[data$building_code %in% test_build2,]
train_data3 <- data[!(data$building_code %in% test_build3),]
test_data3 <- data[data$building_code %in% test_build3,]
train_data4 <- data[!(data$building_code %in% test_build4),]
test_data4 <- data[data$building_code %in% test_build4,]
train_data5 <- data[!(data$building_code %in% test_build5),]
test_data5 <- data[data$building_code %in% test_build5,]
fold1_results <- gr_cv(train_data1, test_data1,
formula1 = formula1,
forumula2 = formula2,
tree_vars = tree_vars,
rf_y = rf_y)
fold2_results <- gr_cv(train_data2, test_data2,
formula1 = formula1,
forumula2 = formula2,
tree_vars = tree_vars,
rf_y = rf_y)
fold3_results <- gr_cv(train_data3, test_data3,
formula1 = formula1,
forumula2 = formula2,
tree_vars = tree_vars,
rf_y = rf_y)
fold4_results <- gr_cv(train_data4, test_data4,
formula1 = formula1,
forumula2 = formula2,
tree_vars = tree_vars,
rf_y = rf_y)
fold5_results <- gr_cv(train_data5, test_data5,
formula1 = formula1,
forumula2 = formula2,
tree_vars = tree_vars,
rf_y = rf_y)
sqrt_gr_test <- c(fold1_results[[1]], fold2_results[[1]], fold3_results[[1]],
fold4_results[[1]], fold5_results[[1]])
gr_test <- c(fold1_results[[2]], fold2_results[[2]], fold3_results[[2]],
fold4_results[[2]], fold5_results[[2]])
rf_gr_test <- c(fold1_results[[3]], fold2_results[[3]], fold3_results[[3]],
fold4_results[[3]], fold5_results[[3]])
og_sqrt_preds <- c(fold1_results[[4]], fold2_results[[4]], fold3_results[[4]],
fold4_results[[4]], fold5_results[[4]])
new_sqrt_preds <- c(fold1_results[[5]], fold2_results[[5]], fold3_results[[5]],
fold4_results[[5]], fold5_results[[5]])
og_gr_preds <- c(fold1_results[[6]], fold2_results[[6]], fold3_results[[6]],
fold4_results[[6]], fold5_results[[6]])
new_gr_preds <- c(fold1_results[[7]], fold2_results[[7]], fold3_results[[7]],
fold4_results[[7]], fold5_results[[7]])
rf_gr_preds <- c(fold1_results[[8]], fold2_results[[8]], fold3_results[[8]],
fold4_results[[8]], fold5_results[[8]])
train_avg <- c(fold1_results[[9]], fold2_results[[9]], fold3_results[[9]],
fold4_results[[9]], fold5_results[[9]])
# rmse(sqrt_gr_test, og_sqrt_preds)
#rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
#median(abs(sqrt_gr_test - og_sqrt_preds))
#median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse_null <- Metrics::rmse(gr_test, train_avg)
rmse_og_build <- Metrics::rmse(gr_test, og_gr_preds)
rmse_new_build <- Metrics::rmse(gr_test[!is.na(new_gr_preds)],
na.omit(new_gr_preds))
rmse_rf_build <- Metrics::rmse(rf_gr_test, rf_gr_preds)
mdae_null_build <- stats::median(abs((gr_test - train_avg)))
mdae_og_build <- stats::median(abs((gr_test - og_gr_preds)))
mdae_new_build <- stats::median(abs((gr_test[!is.na(new_gr_preds)] -
na.omit(new_gr_preds))))
mdae_rf_build <- stats::median(abs((rf_gr_test - rf_gr_preds)))
# Partitioning based on observations
## setting each observation as being in fold 1-5
obs_nums <- sample(rep_len(1:5,nrow(data)))
obs_train_data1 <- data[obs_nums != 1,]
obs_test_data1 <- data[obs_nums == 1,]
obs_train_data2 <- data[obs_nums != 2,]
obs_test_data2 <- data[obs_nums == 2,]
obs_train_data3 <- data[obs_nums != 3,]
obs_test_data3 <- data[obs_nums == 3,]
obs_train_data4 <- data[obs_nums != 4,]
obs_test_data4 <- data[obs_nums == 4,]
obs_train_data5 <- data[obs_nums != 5,]
obs_test_data5 <- data[obs_nums == 5,]
obs_fold1_results <- gr_cv(obs_train_data1, obs_test_data1)
obs_fold2_results <- gr_cv(obs_train_data2, obs_test_data2)
obs_fold3_results <- gr_cv(obs_train_data3, obs_test_data3)
obs_fold4_results <- gr_cv(obs_train_data4, obs_test_data4)
obs_fold5_results <- gr_cv(obs_train_data5, obs_test_data5)
sqrt_gr_test_obs <- c(obs_fold1_results[[1]], obs_fold2_results[[1]],
obs_fold3_results[[1]],
obs_fold4_results[[1]], obs_fold5_results[[1]])
gr_test_obs <- c(obs_fold1_results[[2]], obs_fold2_results[[2]],
obs_fold3_results[[2]],
obs_fold4_results[[2]], obs_fold5_results[[2]])
rf_gr_test_obs <- c(obs_fold1_results[[3]], obs_fold2_results[[3]],
obs_fold3_results[[3]],
obs_fold4_results[[3]], obs_fold5_results[[3]])
og_sqrt_preds_obs <- c(obs_fold1_results[[4]], obs_fold2_results[[4]],
obs_fold3_results[[4]],
obs_fold4_results[[4]], obs_fold5_results[[4]])
new_sqrt_preds_obs <- c(obs_fold1_results[[5]], obs_fold2_results[[5]],
obs_fold3_results[[5]],
obs_fold4_results[[5]], obs_fold5_results[[5]])
og_gr_preds_obs <- c(obs_fold1_results[[6]], obs_fold2_results[[6]],
obs_fold3_results[[6]],
obs_fold4_results[[6]], obs_fold5_results[[6]])
new_gr_preds_obs <- c(obs_fold1_results[[7]], obs_fold2_results[[7]],
obs_fold3_results[[7]],
obs_fold4_results[[7]], obs_fold5_results[[7]])
rf_gr_preds_obs <- c(obs_fold1_results[[8]], obs_fold2_results[[8]],
obs_fold3_results[[8]],
obs_fold4_results[[8]], obs_fold5_results[[8]])
train_avg_obs <- c(obs_fold1_results[[9]], obs_fold2_results[[9]],
obs_fold3_results[[9]],
obs_fold4_results[[9]], obs_fold5_results[[9]])
#rmse(sqrt_gr_test, og_sqrt_preds)
#rmse(sqrt_gr_test[!is.na(new_sqrt_preds)], na.omit(new_sqrt_preds))
#median(abs(sqrt_gr_test - og_sqrt_preds))
#median(abs(sqrt_gr_test[!is.na(new_sqrt_preds)] - na.omit(new_sqrt_preds)))
rmse_null_obs <- Metrics::rmse(gr_test_obs, train_avg_obs)
rmse_og_obs <- Metrics::rmse(gr_test_obs, og_gr_preds_obs)
rmse_new_obs <- Metrics::rmse(gr_test_obs[!is.na(new_gr_preds_obs)],
na.omit(new_gr_preds_obs))
rmse_rf_obs <- Metrics::rmse(rf_gr_test_obs, rf_gr_preds_obs)
mdae_null_obs <- stats::median(abs((gr_test_obs - train_avg_obs)))
mdae_og_obs <- stats::median(abs((gr_test_obs - og_gr_preds_obs)))
mdae_new_obs <- stats::median(abs((gr_test_obs[!is.na(new_gr_preds_obs)] -
na.omit(new_gr_preds_obs))))
mdae_rf_obs <- stats::median(abs((rf_gr_test_obs - rf_gr_preds_obs)))
rmse_new_obs
